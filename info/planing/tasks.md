
# Current Tasks

## Bugs

### 1. model_reasoning_logs

**Описание:**  
Нет адекватных рассуждений модели. В логах только скупой вывод "Модель думает" и вызовы функций. Необходимо добавить вывод рассужений так как это прямое требование технического заданя

### 2. blocking_suspicious_traffic
**Описание:**
система очень часто натыкается на отграничение подозрительного трафика. Попадает на страницы ограничения , провоцирует формы капчи. Самая большая проблема с сайтами OZON и wildberries. Агент даже не может попасть на них. 
**Решение:**
Использовать библиотеку Playwright-stealth

### 3. too_large_get_page_info_context
**Описание:**
Система отдает слишком большой по объему файл с информацией о странице в инструменте get_page_info. Который не помещается в контекст и лимиты. 
**Решение:**
1) Изменить  get_page_info_next_item. - вместо прежней get_page info. Эта функция будет работать следующим образом:
    1) делить изначальный html-документ на нескольько частей с заданными в config.parse_item_size = ... (задан напрямую в config не в переменных окружения) и извлекать все необходимые элементы этой части документа (кнопки, ссылки, селекторы этот состав остается без изменений) и конвертировать в модель Page которую необходимо переименовать в PageItem и добавить поле item_id:int
    2) При этом сохранять весь документ в экземлюяре объекта BrowserManager в виде списка item-ов (на которые был разделен документ)
    3) При повторном вызове функции агентом возвращается следующий item, обрабатывается и передается агенту.
2) Исменить нотацию функции для агента чтобы отразить ее новое назначение
3) Разработать принцип по которому страница будет делится на части чтобы при этом работоспособными оставались библиотечные функции парсинга
4) Добавить тест. Это должен быть один единственный максимально простой тест. Без лишних библиотек. Он должен:
    1) Хардкодом иметь в себе ссылку на страницу.
    2) 4 раза подряд вызвать метод get_page_info_next_item и сохранить результат в json файл в корне проекта в виде списка из 4 словарей- результатов работы функции
---
---
---
---
## Refactoring

no-tasks

---
---
---
---
---
---
---
---
---


# Resolved Tasks
## Fixed Bugs

### 1. function_call_format_error
**Коммит:**
```407342e6468ee7c9a61ebfd18360833fec744c0a```
**Детали:**
Благодаря настройке логирования и введению системы обработки ошибок удалось установить, что причина неверного формата - использование модели `llama-3.3-70b-versatile`, которая реализует tool calling в экспериментальном формате TOON/XML, не поддерживаемом библиотекой LangGraph.

### 2. handle_browser_closing_error
**Коммит:**
```9ae3ea337f600bff3a7dc2541d4d5360dc1f27e0```
**Детали:**
Благодаря строгой обработке ошибок и добавлению декоратора для обработки в инструментах playwright ошибка обрабатывается и завершается работа агента для ожидания дальнейших действий пользователя

---

### 3. escape_error_loop
**Коммит:**
```874c2224765c5267b003f9853ec0940ddcc431f8```
**Детали:**
Задача выполнена благодаря получению кроме ответа модели еще и цепочки её размышлений без крупного изменения функционала.

---

### 4. little_bind_agent
**Коммит:**
```75718ad070dd6b8579c62a2f7c668291533bd972```
**Детали:**
- Добавлен отладочный модуль `debug_collector` для сохранения и анализа полной информации, предоставляемой агенту системой. Модуль обеспечивает глубокое логирование и форматирование информации запроса, ответа агента, размышлений агента и результатов вызова инструментов.
- Переработан инструмент `get_page_info`: первая реализация бездумно обрезала переданную информацию и конвертировала её в сомнительный текстовый формат. Теперь агент получает JSON с данными о странице напрямую, что значительно улучшило понимание контекста.

---




---
---
---
---
## Conducted Refactorings

### 1. domain_error_classes
**Коммит:** 
```407342e6468ee7c9a61ebfd18360833fec744c0a```
**Детали:** 
Реализованы классы доменных ошибок и введена строгая обработка всех входящих ошибок. 